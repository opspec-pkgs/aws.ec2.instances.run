name: build
description: builds the package
inputs:
  version:
    string:
      constraints: { format: semver }
      default: 0.0.0
  pkg:
    dir:
      default: .
  dockerfile:
    file:
      default: /Dockerfile
outputs:
  imageTar:
    file: {}
run:
  serial:
    - op:
        pkg: { ref: test }
        inputs: { pkg }
    - op:
        pkg: { ref: github.com/opspec-pkgs/docker.image.build#1.1.0 }
        inputs: { dockerfile, imageName: 'opspecpkgs/aws.ec2.instances.run:$(version)' }
        outputs: { imageTar }
